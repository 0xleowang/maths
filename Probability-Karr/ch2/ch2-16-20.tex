% Exercise 2.16
\begin{exercise}
  Let $X$ have distribution $N(0,1)$. Calculate the density of $Y=e^X$, which is said to have a \textit{log normal distribution}.
\end{exercise}
\begin{solution}
  We can write $Y=e^X$ as $Y=g(X)$ where $g(x):=e^x$. Then $g$ has an inverse function $h(y)=\log y$ that has derivative $h'(y)=1/y$. By Theorem 2.41, we have
  \[
    f_Y(y)=f_X(h(y))|h'(t)| = f_X(\log y)/y = \frac{1}{\sqrt{2\pi}y}e^{-(\log y)^2/2}, \quad y>0.
  \]
\end{solution}


% Exercise 2.17
\begin{exercise}
  Let $Y=g(X)$, where $X$ is a random variable and $g:\bR\to\bR$ is Borel measurable. Prove tha t$\sigma(Y)\subseteq\sigma(X)$. Conclude that if also $X=h(Y)$ for some $h$, then $\sigma(X) =\sigma(Y)$.
\end{exercise}
\begin{solution}
  As $g$ is Borel measurable, $g^{-1}(B)\in\cB(\bR)$ for every $B\in\cB(\bR)$. Thus,
  \begin{align*}
    \sigma(Y) &= \{Y^{-1}(B):B\in\cB(\bR)\} \\
      &= \{X^{-1}(g^{-1}(B)):B\in\cB(\bR)\} \\
      &\subseteq \{X^{-1}(B):B\in\cB(\bR)\} = \sigma(X).
  \end{align*}
  If $X=h(Y)$ for some Borel measurable function $h$, then $\sigma(X)\subseteq \sigma(Y)$, and hence $\sigma(X)=\sigma(Y)$.
\end{solution}


% Exercise 2.18
\begin{exercise}
  Prove that if $U\deq U[0, 1]$, and $\lambda>0$, then
  \[ X = -(1/\lambda)\log U \]
  satisfies $X\deq E(\lambda)$.
\end{exercise}
\begin{solution}
  Let $g(u)=-(1/\lambda)\log u$, then $X=g(U)$. As $g(u)$ is monotonically descreasing in $u>0$, it has an inverse function $h(x)=e^{-\lambda x}$ with the derivative $h'(x)=-\lambda E^{-\lambda x}$. Since $U\in(0, 1]$, $X$ has values in $[0, \infty)$. Applying the Theorem 2.41,
  \begin{align*}
    f_X(x) = f_U(h(x))|h'(x)| = \lambda e^{-\lambda x}, \quad x\geq 0,
  \end{align*}
  which has the same density function as $E(\lambda)$. Hence their distribution functions must be the same and $X\deq E(\lambda)$.
\end{solution}


% Exercise 2.19
\begin{exercise}
  Calculate the density function of $Y=1/X - X$, where $X\deq U[0, 1]$.
\end{exercise}
\begin{solution}
  Solve $y=1/x - x$ and write $x$ in terms of $y$, we can get $X = -\frac{Y}{2} + \demi\sqrt{4+Y^2}$ or $X = -\frac{Y}{2} - \demi\sqrt{4+Y^2}$. As $X\in[0, 1]$, only $X = -\frac{Y}{2} + \demi\sqrt{4+Y^2}$ is valid. Moreover, $Y$ has values in $[0, \infty)$. Let $h(y)=-\frac{y}{2} + \demi\sqrt{4+y^2}$, then $X=h(Y)$. Given $h'(y)=-\demi + \frac{y}{2\sqrt{4+y^2}}$, applying Theorem 2.41, we can get the density of $Y$:
  \[
    f_Y(y) = f_U(h(y))|h'(y)| = 1\cdot |-\demi+\frac{y}{2\sqrt{4+y^2}}| = \demi - \frac{y}{2\sqrt{4+y^2}}, \quad y\geq 0.
  \]
  (The answer can be verified by checking $\int_0^\infty f_Y(y)dy = 1$.)
\end{solution}


% Exercise 2.20
\begin{exercise}
  Suppose that $Y=X^2$. \\
  a) Prove that for $t\geq 0$,
  \[ F_Y(t) = F_X(\sqrt{t}) - F_X((-\sqrt{t})-). \]
  b) Prove that if $X$ is absolutely continuous, then $Y$ is absolutely continuous with
  \[ f_Y(y) = \frac{f_X(\sqrt{y}) + f_X(-\sqrt{y})}{2\sqrt{y}}, \quad y>0. \]
  c) Prove that if $X\deq N(0, 1)$, then $Y$ has a $\chi^2$ distribution with one degree of freedom.
\end{exercise}
\begin{solution}
  a) For $t\geq 0$,
  \begin{align}\label{eq:2.20b}
    F_Y(t) &= P\{Y\leq t\} = P\{X^2\leq t\} = P\{-\sqrt{t}\leq X\leq\sqrt{t}\} \\
      &= P\{X\leq\sqrt{t}\} - P\{X<-\sqrt{t}\} = F_X(\sqrt{t}) - F_X((-\sqrt{t})-) .
  \end{align}

  b) If $X$ is absolutely continuous, then $X$ has a density function $f(t)=F'(t)$. Differentiating on both sides of \eqref{eq:2.20b}, we have
  \[ f_Y(t) = F'_X(\sqrt{t}) - F'_X(-\sqrt{t}) = \frac{f_X(\sqrt{t})+f_X(-\sqrt{t})}{2\sqrt{Y}} , \quad t\geq 0. \]
  The density has support on $[0,\infty)$ as $Y= X^2\geq 0$.

  c) If $X\deq N(0, 1)$, then $f_X(x)=\frac{1}{\sqrt{2\pi}}e^{-x^2/2}$. From b), we have
  \[ f_Y(y) = \frac{e^{-y/2}/\sqrt{2\pi}+e^{-y/2}/\sqrt{2\pi}}{2\sqrt{y}} = \frac{1}{\sqrt{2\pi y}}e^{-y/2} ,\quad y\geq 0 .\]
  Recall that a $\chi^2$ distribution with one degree of freedom has the density function
  \[ f(x)=\frac{1}{\Gamma(\alpha)}\lambda^\alpha e^{-\lambda x}x^{\alpha-1} ,\quad x\geq 0, \]
  where $\alpha = \lambda = 1$. Since $\Gamma(\demi) = \sqrt{\pi}$, we have $f(x) = \frac{1}{\sqrt{2\pi x}}e^{-x/2}$. As $Y$ has the same density function as $\chi^2$ with one degree of freedom, their distribution functions must be the same and hence they are identically distributed.
\end{solution}

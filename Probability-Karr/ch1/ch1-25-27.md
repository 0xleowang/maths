# Chapter 1. Probability

## Exercise 1.25
Let $A_1,\ldots,A_n$ be events, and for $J\subseteq \lbrace 1,\ldots,n \rbrace$, let $B_J=\cap_{j\in J}A_j$. For $k\geq 1$, let $S_k=\Sigma_{|J|=k}P(B_J)$, where the sum is over all subsets $J$ of $\lbrace 1,\ldots,n \rbrace$ with $|J|=k$.

a) Prove the _inclusion-exclusion principle_:

$$ P(\bigcup_{i=1}^n A_i) = \Sigma_{k=1}^n (-1)^{k-1}S_k .$$

b) Suppose that $P(B_J)$ depends only on $|J|$, i.e., there are numbers $q_0,\ldots,q_n$ such that $P(B_J)=q_k$ whenever $|J|=k$. (This is true, for example, in Exercise 1.15.) Prove that $S_k = \binom{n}{k} q_k$.

### Solution

a) Prove the inclusion-exclusion principle by induction is such a pain. Here we show a simpler proof by borrowing Definition 4.1 of expectation.

Using indicator functions, we have

$$ \mathbb{1}_{\cup_{i=1}^n A_i} = 1 - \mathbb{1}_{\cap_{i=1}^n A_i^c} = 1 - \prod_{i=1}^n (1 - \mathbb{1}_{A_i}) . $$

Expanding this equation, we can get

$$ \mathbb{1}_{\cup_{i=1}^n A_i} = \Sigma_{k=1}^n(-1)^{k-1}\Sigma_{|J|=k}\prod_{j\in J}\mathbb{1}_{A_j} .$$

Taking expectation from both sides tives the inclusion-exclusion principle.

b) As $\binom{n}{k}$ represents the number of combinations of choosing $k$ from $n$:

$$S_k=\Sigma_{|J|=k}P(B_J) = \Sigma_{|J|=k}q_k = \binom{n}{k}q_k. $$


## Exercise 1.26
This is known as the _coupon collector's problem_. There are $t$ different types of coupons available and the collector is seeking to collect one of each (for example, in order to win some premium). Show that if $n$ coupons have been collected, then the probability $p_n$ of having at least one of each type is

$$ p_n = \Sigma_{k=1}^t(-1)^{k-1}\binom{t}{k}\Big(1 - \frac{k}{t}\Big)^n .$$

### Solution

Let $A_i$ be the event that the $i$-th type coupon is missing when $n$ coupons have been collected, and $\cup_{i=1}^t A_i$ is the event that at least one type is missing. Then the event of having at least one of each type is the complement of $\cup_{i=1}^t A_i$. By applying the inclusion-exclusion principle (from exercise 1.25),

$$ P(\cup_{i=1}^n A_i) = \Sigma_{k=1}^n(-1)^{k-1}S_k $$

where $S_k=\Sigma_{|J|=k}P(B_J)$ and $B_J=\cap_{j\in J}A_j$. In this problem, $B_J$ is the event that all the types in $J$ are missing once $n$ coupons have been collected, and

$$ P(B_J) = \Big(1 - \frac{k}{t} \Big)^n .$$

Since $P(B_J)$ depends only on $|J|=k$, applying exercise 1.25 b), $S_k = \binom{n}{k}\Big(1 - \frac{k}{t} \Big)^n$ and

$$ P(\cup_{i=1}^n A_i) = \Sigma_{k=1}^n(-1)^{k-1}\binom{n}{k}\Big(1 - \frac{k}{t} \Big)^n .$$

Therefore, the probability $p_n$ of having at least one of each type is

$$ p_n = 1 - P(\cup_{i=1}^n A_i) = 1 - \Sigma_{k=1}^n(-1)^{k-1}\binom{n}{k}\Big(1 - \frac{k}{t} \Big)^n. $$

(Note: It seems like there is an erratum in this exercise.)

